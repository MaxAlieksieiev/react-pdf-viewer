"use strict";var e=require("react/jsx-runtime"),t=require("@react-pdf-viewer/core"),n=require("react"),r=require("react-dom");function i(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var o=i(n),a=function(){return e.jsx(t.Icon,{size:16,children:e.jsx("path",{d:"M7.5,19.499h9 M7.5,16.499h9 M5.5,16.5h-3c-1.103-0.003-1.997-0.897-2-2v-6c0.003-1.103,0.897-1.997,2-2h19\n            c1.103,0.003,1.997,0.897,2,2v6c-0.003,1.103-0.897,1.997-2,2h-3\n            M5.5,4.5v-4h9.586c0.265,0,0.52,0.105,0.707,0.293l2.414,2.414\n            C18.395,3.394,18.5,3.649,18.5,3.914V4.5\n            M18.5,22.5c0,0.552-0.448,1-1,1h-11c-0.552,0-1-0.448-1-1v-9h13V22.5z\n            M3.5,8.499\n            c0.552,0,1,0.448,1,1s-0.448,1-1,1s-1-0.448-1-1S2.948,8.499,3.5,8.499z\n            M14.5,0.499v4h4"})})},s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var c,u={left:0,top:8},p=function(n){var r=n.enableShortcuts,i=n.onClick,s=o.useContext(t.LocalizationContext).l10n,c=s&&s.print?s.print.print:"Print",p=r?t.isMac()?"Meta+P":"Ctrl+P":"";return e.jsx(t.Tooltip,{ariaControlsSuffix:"print",position:t.Position.BottomCenter,target:e.jsx(t.MinimalButton,{ariaKeyShortcuts:p,ariaLabel:c,testId:"print__button",onClick:i,children:e.jsx(a,{})}),content:function(){return c},offset:u})};!function(e){e.CheckingPermission="CheckingPermission",e.Inactive="Inactive",e.Preparing="Preparing",e.Cancelled="Cancelled",e.Ready="Ready"}(c||(c={}));var l=function(e){var t=e.children,n=e.enableShortcuts,r=e.store;return(t||p)({enableShortcuts:n,onClick:function(){r.update("printStatus",c.CheckingPermission)}})},d=function(n){var r=n.doc,i=n.store,a=o.useContext(t.LocalizationContext).l10n,s=o.useState(!0),u=s[0],p=s[1];return o.useEffect((function(){r.getPermissions().then((function(e){null===e||e.includes(4)||e.includes(2048)?i.update("printStatus",c.Preparing):p(!1)}))}),[]),u?e.jsx(e.Fragment,{}):e.jsx(t.Modal,{ariaControlsSuffix:"print-permission",closeOnClickOutside:!1,closeOnEscape:!1,content:function(n){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"rpv-print__permission-body",children:a&&a.print?a.print.disallowPrint:"The document does not allow to print"}),e.jsx("div",{className:"rpv-print__permission-footer",children:e.jsx(t.Button,{onClick:function(){n(),i.update("printStatus",c.Cancelled)},children:a&&a.print?a.print.close:"Close"})})]})},isOpened:!0})},f=function(n){var r=n.numLoadedPages,i=n.numPages,a=n.onCancel,s=o.useContext(t.LocalizationContext).l10n,c=o.useContext(t.ThemeContext).direction===t.TextDirection.RightToLeft,u=Math.floor(100*r/i);return e.jsx("div",{className:"rpv-print__progress",children:e.jsxs("div",{className:t.classNames({"rpv-print__progress-body":!0,"rpv-print__progress-body--rtl":c}),children:[e.jsx("div",{className:"rpv-print__progress-message",children:s&&s.print?s.print.preparingDocument:"Preparing document ..."}),e.jsx("div",{className:"rpv-print__progress-bar",children:e.jsx(t.ProgressBar,{progress:u})}),e.jsx(t.Button,{onClick:a,children:s&&s.print?s.print.cancel:"Cancel"})]})})},g=function(n){var r=n.canvas,i=n.page,a=n.pageHeight,s=n.pageIndex,c=n.pageWidth,u=n.rotation,p=n.onLoad,l=t.useIsMounted(),d=o.useRef(),f=o.useState(""),g=f[0],m=f[1],v=o.useMemo((function(){return"undefined"!=typeof process&&void 0!==process.env.JEST_WORKER_ID}),[]);return o.useEffect((function(){var e=d.current;e&&e.cancel();var t=150/72;r.height=Math.floor(a*t),r.width=Math.floor(c*t);var n=r.getContext("2d");n.save(),n.fillStyle="rgb(255, 255, 255)",n.fillRect(0,0,r.width,r.height),n.restore();var o=i.getViewport({rotation:u,scale:1});d.current=i.render({canvasContext:n,intent:"print",transform:[t,0,0,t,0,0],viewport:o}),d.current.promise.then((function(){"toBlob"in r&&"createObjectURL"in URL?r.toBlob((function(e){l.current&&m(URL.createObjectURL(e)),v&&p()})):(l.current&&m(r.toDataURL()),v&&p())}),(function(){}))}),[]),g&&e.jsx("div",{className:"rpv-print__page",children:e.jsx("img",{"data-testid":"print__thumbnail-".concat(s),src:g,onLoad:function(){v||p()}})})},m=function(n){var r=n.canvas,i=n.doc,a=n.pageIndex,s=n.pageRotation,c=n.pageSize,u=n.rotation,p=n.shouldRender,l=n.onLoad,d=t.useIsMounted(),f=o.useState(null),m=f[0],v=f[1],h=Math.abs(u+s)%180==0;o.useEffect((function(){p&&t.getPage(i,a).then((function(e){d.current&&v(e)}))}),[p]);var x=(c.rotation+u+s)%360;return m&&e.jsx(g,{canvas:r,page:m,pageHeight:h?c.pageHeight:c.pageWidth,pageIndex:a,pageWidth:h?c.pageWidth:c.pageHeight,rotation:x,onLoad:l})},v=function(t){var n=t.doc,i=t.numLoadedPages,a=t.pagesRotation,s=t.pageSizes,u=t.printPages,p=t.printStatus,l=t.rotation,d=t.onCancel,f=t.onLoad,g=o.useMemo((function(){return document.createElement("canvas")}),[]),v=o.useMemo((function(){var e=document.querySelector(".rpv-print__zone");if(e)return e;var t=document.createElement("div");return t.classList.add("rpv-print__zone"),t.setAttribute("data-testid","print__zone"),document.body.appendChild(t),t}),[]);o.useEffect((function(){p===c.Ready&&(document.documentElement.classList.add("rpv-print__html-printing"),document.body.classList.add("rpv-print__body-printing"),window.print());var e=function(){if(p===c.Ready){document.documentElement.classList.remove("rpv-print__html-printing"),document.body.classList.remove("rpv-print__body-printing");var t=document.querySelectorAll(".rpv-print__zone");t&&t.forEach((function(e){e.parentElement.removeChild(e)})),g.height=0,g.width=0,document.removeEventListener("mousemove",e),d()}};return document.addEventListener("mousemove",e),function(){return document.removeEventListener("mousemove",e)}}),[p]);var h=s[0].pageHeight,x=s[0].pageWidth;return r.createPortal(e.jsxs(e.Fragment,{children:[u.map((function(t,r){return e.jsx(m,{canvas:g,doc:n,pageIndex:t,pageRotation:a.has(t)?a.get(t):0,pageSize:s[t],rotation:l,shouldRender:r===i,onLoad:f},t)})),e.jsx("style",{dangerouslySetInnerHTML:{__html:"@page { size: ".concat(x,"pt ").concat(h,"pt }")}})]}),v)},h=function(t){var n=t.doc,r=t.pagesRotation,i=t.pageSizes,a=t.renderProgressBar,s=t.rotation,u=t.setPages,p=t.store,l=o.useState(c.Inactive),g=l[0],m=l[1],h=o.useState(0),x=h[0],P=h[1],j=o.useMemo((function(){var e=n.numPages;return u(n).filter((function(t){return t>=0&&t<e}))}),[n,u]),C=j.length,b=function(){P(0),m(c.Inactive)},_=function(e){return m(e)};return o.useEffect((function(){return p.subscribe("printStatus",_),function(){p.unsubscribe("printStatus",_)}}),[]),e.jsxs(e.Fragment,{children:[g===c.CheckingPermission&&e.jsx(d,{doc:n,store:p}),g===c.Preparing&&(a?a(x,C,b):e.jsx(f,{numLoadedPages:x,numPages:C,onCancel:b})),(g===c.Preparing||g===c.Ready)&&x<=C&&e.jsx(v,{doc:n,numLoadedPages:x,pagesRotation:r,pageSizes:i,printPages:j,printStatus:g,rotation:s,onCancel:b,onLoad:function(){var e=x+1;e<=C&&(P(e),e===C&&m(c.Ready))}})]})},x=function(n){var r=n.onClick,i=o.useContext(t.LocalizationContext).l10n,s=i&&i.print?i.print.print:"Print";return e.jsx(t.MenuItem,{icon:e.jsx(a,{}),testId:"print__menu",onClick:r,children:s})},P=function(n){var r=n.containerRef,i=n.store,a=function(e){if(!e.shiftKey&&!e.altKey&&"p"===e.key&&(t.isMac()?e.metaKey:e.ctrlKey)){var n=r.current;n&&document.activeElement&&n.contains(document.activeElement)&&(e.preventDefault(),i.update("printStatus",c.Preparing))}};return o.useEffect((function(){if(r.current)return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}}),[r.current]),e.jsx(e.Fragment,{})};exports.PrintIcon=a,exports.getAllPagesNumbers=function(e){return Array(e.numPages).fill(0).map((function(e,t){return t}))},exports.getCustomPagesNumbers=function(e){return function(t){var n,r=[];return e.replace(/\s+/g,"").split(",").forEach((function(e){var t,n,i=e.split("-").map((function(e){return parseInt(e,10)})).filter((function(e){return Number.isInteger(e)}));1===i.length?r.push(i[0]-1):2===i.length&&r.push.apply(r,(t=i[0]-1,n=i[1]-1,Array(n-t+1).fill(0).map((function(e,n){return t+n}))))})),(n=r,n.filter((function(e){return n.indexOf(e)===n.lastIndexOf(e)}))).filter((function(e){return e>=0&&e<t.numPages}))}},exports.getEvenPagesNumbers=function(e){return Array(e.numPages).fill(0).map((function(e,t){return t})).filter((function(e){return(e+1)%2==0}))},exports.getOddPagesNumbers=function(e){return Array(e.numPages).fill(0).map((function(e,t){return t})).filter((function(e){return(e+1)%2==1}))},exports.printPlugin=function(n){var r=o.useMemo((function(){return Object.assign({},{enableShortcuts:!0,setPages:function(e){return Array(e.numPages).fill(0).map((function(e,t){return t}))}},n)}),[]),i=o.useMemo((function(){return t.createStore({printStatus:c.Inactive})}),[]),a=function(t){return e.jsx(l,s({enableShortcuts:r.enableShortcuts},t,{store:i}))};return{print:function(){i.update("printStatus",c.CheckingPermission)},renderViewer:function(t){var o=t.slot,a={children:e.jsxs(e.Fragment,{children:[r.enableShortcuts&&e.jsx(P,{containerRef:t.containerRef,store:i}),e.jsx(h,{doc:t.doc,pagesRotation:t.pagesRotation,pageSizes:t.pageSizes,renderProgressBar:null==n?void 0:n.renderProgressBar,rotation:t.rotation,setPages:r.setPages,store:i}),o.children]})};return s(s({},o),a)},Print:a,PrintButton:function(){return e.jsx(a,{children:function(t){return e.jsx(p,s({},t))}})},PrintMenuItem:function(t){return e.jsx(a,{children:function(n){return e.jsx(x,{onClick:function(){n.onClick(),t.onClick()}})}})},setPages:function(e){r.setPages=e}}};
