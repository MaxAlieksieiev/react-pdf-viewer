"use strict";var e=require("react/jsx-runtime"),r=require("@react-pdf-viewer/core");function t(e){var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var o=t(require("react")),n=function(){return e.jsx(r.Icon,{size:16,children:e.jsx("path",{d:"M12,1.001c6.075,0,11,4.925,11,11s-4.925,11-11,11s-11-4.925-11-11S5.925,1.001,12,1.001z\n            M14.5,17.005H13\n            c-0.552,0-1-0.448-1-1v-6.5c0-0.276-0.224-0.5-0.5-0.5H10\n            M11.745,6.504L11.745,6.504\n            M11.745,6.5c-0.138,0-0.25,0.112-0.25,0.25\n            S11.607,7,11.745,7s0.25-0.112,0.25-0.25S11.883,6.5,11.745,6.5"})})},i=function(){return i=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e},i.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var s=function(t){var n=t.doc,i=t.render,s=o.useState(),a=s[0],c=s[1];return o.useEffect((function(){n.getMetadata().then((function(e){return Promise.resolve(e)})).then((function(e){return n.getDownloadInfo().then((function(r){return Promise.resolve({fileName:e.contentDispositionFilename||"",info:e.info,length:r.length})}))})).then((function(e){c(e)}))}),[]),a?i(a):e.jsx("div",{className:"rpv-properties__loader",children:e.jsx(r.Spinner,{})})},a=function(t){var n=t.label,i=t.value,s=o.useContext(r.ThemeContext).direction===r.TextDirection.RightToLeft;return e.jsxs("dl",{className:r.classNames({"rpv-properties__item":!0,"rpv-properties__item--rtl":s}),children:[e.jsxs("dt",{className:"rpv-properties__item-label",children:[n,":"]}),e.jsx("dd",{className:"rpv-properties__item-value",children:i||"-"})]})},c=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"),p=function(e,r,t,o){var n=parseInt(e,10);return n>=r&&n<=t?n:o},l=function(t){var n=t.doc,i=t.fileName,l=t.onToggle,u=o.useContext(r.LocalizationContext).l10n,f=function(e){var r=function(e){var r=c.exec(e);if(!r)return null;var t=parseInt(r[1],10),o=p(r[2],1,12,1)-1,n=p(r[3],1,31,1),i=p(r[4],0,23,0),s=p(r[5],0,59,0),a=p(r[6],0,59,0),l=r[7]||"Z",u=p(r[8],0,23,0),f=p(r[9],0,59,0);switch(l){case"-":i+=u,s+=f;break;case"+":i-=u,s-=f}return new Date(Date.UTC(t,o,n,i,s,a))}(e);return r?"".concat(r.toLocaleDateString(),", ").concat(r.toLocaleTimeString()):""};return e.jsxs("div",{className:"rpv-properties__modal",children:[e.jsx(s,{doc:n,render:function(t){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rpv-properties__modal-section",children:[e.jsx(a,{label:u&&u.properties?u.properties.fileName:"File name",value:t.fileName||(c=i,p=c.split("/").pop(),p?p.split("#")[0].split("?")[0]:c)}),e.jsx(a,{label:u&&u.properties?u.properties.fileSize:"File size",value:(o=t.length,s=Math.floor(Math.log(o)/Math.log(1024)),"".concat((o/Math.pow(1024,s)).toFixed(2)," ").concat(["B","kB","MB","GB","TB"][s]))})]}),e.jsx(r.Separator,{}),e.jsxs("div",{className:"rpv-properties__modal-section",children:[e.jsx(a,{label:u&&u.properties?u.properties.title:"Title",value:t.info.Title}),e.jsx(a,{label:u&&u.properties?u.properties.author:"Author",value:t.info.Author}),e.jsx(a,{label:u&&u.properties?u.properties.subject:"Subject",value:t.info.Subject}),e.jsx(a,{label:u&&u.properties?u.properties.keywords:"Keywords",value:t.info.Keywords}),e.jsx(a,{label:u&&u.properties?u.properties.creator:"Creator",value:t.info.Creator}),e.jsx(a,{label:u&&u.properties?u.properties.creationDate:"Creation date",value:f(t.info.CreationDate)}),e.jsx(a,{label:u&&u.properties?u.properties.modificationDate:"Modification date",value:f(t.info.ModDate)})]}),e.jsx(r.Separator,{}),e.jsxs("div",{className:"rpv-properties__modal-section",children:[e.jsx(a,{label:u&&u.properties?u.properties.pdfProducer:"PDF producer",value:t.info.Producer}),e.jsx(a,{label:u&&u.properties?u.properties.pdfVersion:"PDF version",value:t.info.PDFFormatVersion}),e.jsx(a,{label:u&&u.properties?u.properties.pageCount:"Page count",value:"".concat(n.numPages)})]})]});var o,s,c,p}}),e.jsx("div",{className:"rpv-properties__modal-footer",children:e.jsx(r.Button,{onClick:l,children:u&&u.properties?u.properties.close:"Close"})})]})},u={left:0,top:8},f=function(t){var i=t.onClick,s=o.useContext(r.LocalizationContext).l10n,a=s&&s.properties?s.properties.showProperties:"Show properties";return e.jsx(r.Tooltip,{ariaControlsSuffix:"properties",position:r.Position.BottomCenter,target:e.jsx(r.MinimalButton,{ariaLabel:a,testId:"properties__button",onClick:i,children:e.jsx(n,{})}),content:function(){return a},offset:u})},d=function(t){var n=t.children,s=t.store,a=function(e){var r=o.useState(e.get("doc")),t=r[0],n=r[1],i=function(e){n(e)};return o.useEffect((function(){return e.subscribe("doc",i),function(){e.unsubscribe("doc",i)}}),[]),{currentDoc:t}}(s).currentDoc,c=s.get("fileName")||"",p=n||function(r){return e.jsx(f,i({},r))};return a?e.jsx(r.Modal,{ariaControlsSuffix:"properties",target:function(e){return p({onClick:e})},content:function(r){return e.jsx(l,{doc:a,fileName:c,onToggle:r})},closeOnClickOutside:!0,closeOnEscape:!0}):e.jsx(e.Fragment,{})},x=function(t){var i=t.onClick,s=o.useContext(r.LocalizationContext).l10n,a=s&&s.properties?s.properties.showProperties:"Show properties";return e.jsx(r.MenuItem,{icon:e.jsx(n,{}),testId:"properties__menu",onClick:i,children:a})};exports.InfoIcon=n,exports.propertiesPlugin=function(){var t=o.useMemo((function(){return r.createStore({fileName:""})}),[]),n=function(r){return e.jsx(d,i({},r,{store:t}))};return{onDocumentLoad:function(e){t.update("doc",e.doc)},onViewerStateChange:function(e){return t.update("fileName",e.file.name),e},ShowProperties:n,ShowPropertiesButton:function(){return e.jsx(d,{store:t})},ShowPropertiesMenuItem:function(r){return e.jsx(n,{children:function(r){return e.jsx(x,i({},r))}})}}};
